<!doctype html>
<html>
<head>
	<meta charset="UTF-8" />
	<meta http-equiv="Expires" content="0" />
	<meta name="renderer" content="webkit" />
	<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
	<title>${siteTitle!}</title>
	<link rel="stylesheet" type="text/css" href="${resPath}/bcrc-mobile/css/ly_html.css">
	<link rel="stylesheet" type="text/css" href="${resPath}/bcrc-mobile/css/bcrc-phone-body.css">
	<link rel="stylesheet" type="text/css" href="${resPath}/bcrc-mobile/css/bcrc-phone-page.css">
	<link rel="stylesheet" href="${resPath}/bcrc-mobile/css/sy_sjbase.css"  />
	<link rel="stylesheet" href="${resPath}/bcrc-mobile/css/cover.css"  />
	<link rel="stylesheet" href="${resPath}/bcrc-mobile/css/swiper.min.css"  />
	<link rel="stylesheet" href="${resPath}/bcrc-mobile/css/resume.css"  />
	<link rel="stylesheet" href="${resPath}/bcrc-mobile/css/pop.css"  />
	<script type="text/javascript" src="${resPath}/syrc-mobile/images/jquery-2.1.1.min.js"></script>
	<script type="text/javascript" src="${resPath}/syrc-mobile/images/basic.js" ></script>
	<script type="text/javascript" src="${resPath}/syrc-mobile/images/zepto.js"></script>
	<script type="text/javascript" src="${resPath}/syrc-mobile/images/swiper.min.js"></script>




	<script type="text/javascript">
		var _tkd = _tkd || [];
		var $_CONFIG = {};
		//$_CONFIG['domain'] = '//m.51job.com/';
		//$_CONFIG['imgpath'] = '//img01.51jobcdn.com/im/m';
		//$_CONFIG['jspath'] = '//js.51jobcdn.com/in/js/h5';
		//$_CONFIG['template'] = 'resume/baseinfo';
		$_CONFIG['islogin'] = '1';
		$_CONFIG['jobarea'] = '030800';
		$_CONFIG['jobareaname'] = '东莞';
		$_CONFIG['ip'] = '36.48.27.149';
		$_CONFIG['guid'] = 'db7398e3a4d3205cf89c37f039c6005f';
	</script>
</head>
<body id="m_45" onload="update();">
@includeFileTemplate("/www/syrc-mobile/include/qyzx-header.html",{"current":"index"}){}
<!--内容开始-->
<div class="wz_cont grzx_in">
	<div  class="wz_cont_in">
		<div class="touxiangbox">
			<div class="con_left">
				<div class="all_title"><a href="${ctxPath}/qyzx/goToQyzxQyxxxgJbxx"><span>基本信息</span></a><a href="${ctxPath}/qyzx/goToLogoxg"><span>logo上传</span></a></div>
				<input type="hidden" name="qy_id" id="qy_id" value="${qyInfo.qy_id!}"/>
				<input type="hidden" name="zh_id" id="zh_id" value="${qyInfo.zh_id!}"/>
				<div class="sbox" ng-controller="appCtrl">
					<div class="e">
						<label><em>*</em>企业名称</label>
						<input type="text" class="txt inputblur" name="qy_qymc" id="qy_qymc" value="${qyInfo.qy_qymc!}" maxlength="20" value="" placeholder="（必填）请输入企业名称" />
						<p class="error" style="display:none;" id="err_cqymc"><span></span></p>
					</div>
					<div class="e">
						<label><em>*</em>营业执照</label>
						<a class="xx_logo" id="sc">
							@if(isNotEmpty(qyInfo.qy_file_zz)){
							<img src="${qyInfo.qy_file_zz!}"  />
							@}else{
							上传
							<img src="" />
							@}
						</a>
					</div>
					<input style='display:none;' type="file"  id="myfile"  name="myfile" onchange="printFileInfo(this)" accept='image/*' multiple="multiple"/>
					<a href="javascript:void(0)" class="e">
						<label><em>*</em>所属行业</label>
						<!-- <div class="txt c_default">请选择</div> -->
						<div href="javascript:void(0)" id="indtypename" class="txt c_default" onclick="setIndtypePage(this,1);">\
							@if(isNotEmpty(qyInfo.qy_sshy!)){
							${qyInfo.qy_sshy!}
							@}
							@else{
							请选择
							@}
						</div>
						<input type="hidden" id="indtype_code" value="" name="industrytype" >
					</a>
					<div class="e">
						<label><em>*</em>企业类型</label>
						<div class="selt">
							<span class="sval" id="qy_jjlxspan">请选择</span>
							<input type="hidden" id="jjlx" value="">
							<select id="qy_jjlx">
								<option value="0">国有企业</option>
								<option value="1">集体企业</option>
								<option value="2" >私营企业</option>
								<option value="3" >个体企业</option>
								<option value="4" >联营企业</option>
								<option value="5" >股份制企业</option>
								<option value="6" >外商投资企业</option>
								<option value="7" >港澳台投资企业</option>
								<option value="8" >其他企业</option>
							</select>
						</div>
					</div>
					<div class="e">
						<label><em>*</em>企业规模</label>
						<div class="selt">
							<span class="sval" id="qy_qygmspan">请选择</span>
							<input type="hidden" id="qygm" value="">
							<select id="qy_qygm">
								<option value="0" >20人以下</option>
								<option value="1" >20-99人</option>
								<option value="2" >100-499人</option>
								<option value="3" >500-999人</option>
								<option value="4" >1000-9999人</option>
								<option value="5" >10000人以上</option>
							</select>
						</div>
					</div>
					<div class="e e_ta">
						<label>企业简介</label>
						<div class="ptxa">
							<textarea maxlength="2000"  id="qy_qyjl" class="inputblur" placeholder="描述企业简历，限1000中文字">${qyInfo.qy_qyjl!}</textarea>
							<div class="gray">
								@if(isNotEmpty(qyInfo.qy_qyjl)){
								${strutil.length(qyInfo.qy_qyjl)}
								@}else{
								0
								@}
								/1000</div>
						</div>
						<p class="error" style="display:none;" id="err_qy_qyjl"><span></span></p>
					</div>
					<div class="e">
						<label>企业福利</label>
						<div class="rdob" id="workzwld">
							<label class=" on" ><input type="checkbox"  id="qy_qyfl" name="qy_qyfl"  value="1"/>五险一金</label>
							<label class="" ><input type="checkbox"  id="qy_qyf2" name="qy_qyfl"  value="2" />节日福利</label>
							<label class="" ><input type="checkbox" id="qy_qyf3" name="qy_qyfl"  value="3" />带薪年假</label>
							<label class="" ><input type="checkbox"  id="qy_qyf4" name="qy_qyfl"  value="4" />现金补贴</label>
						</div>
					</div>
					<div class="e">
						<label>企业网址</label>
						<input type="text" class="txt inputblur" id="qy_qywz" maxlength="100"  placeholder="请输入企业网址"  value="${qyInfo.qy_qywz!}"/>

					</div>
					<div class="e">
						<label><em>*</em>联系人</label>
						<input type="text" class="txt inputblur"  id="qy_lxr" value="${qyInfo.qy_lxr!}" maxlength="20" value="" placeholder="（必填）请输入企业联系人" />
						<p class="error" style="display:none;" id="err_qy_lxr"><span></span></p>
					</div>
					<div class="e">
						<label>联系电话</label>
						<input type="text" class="txt inputblur"  id="qy_lxdh" value="${qyInfo.qy_lxdh!}"maxlength="11" value="" placeholder="请输入企业网址" oninput="if(value.length>11)value=value.slice(0,11)"/>
					</div>
					<div class="e">
						<label><em>*</em>邮编</label>
						<input type="text" class="txt inputblur" value="${qyInfo.qy_yx!}"  maxlength="10"  placeholder="请输入邮政编码" id="qy_yx" />
						<p class="error" style="display:none;" id="err_qy_yx"><span></span></p>
					</div>
					<div class="e">
						<label><em>*</em>详细地址</label>
						<input type="text" class="txt inputblur"  id="qy_xxdz" value="${qyInfo.qy_xxdz!}"  maxlength="20" value="" placeholder="（必填）请输入企业详细地址" />
						<p class="error" style="display:none;" id="err_qy_xxdz"><span></span></p>
					</div>
					<center class="btnbox">
						<a href="javascript:void(0); "><button class="btn" onclick="submit()" >保存</button></a>
						<input type="hidden" id="rsmid" value="398719117"/>
					</center>
				</div>


			</div>
		</div>
	</div>
</div>
<!--内容结束-->
@includeFileTemplate("/www/syrc-mobile/include/footer.html",{"current":"index"}){}
<script type="text/javascript" src="${resPath}/bcrc-mobile/js/base.js"></script>
<script type="text/javascript" src="${resPath}/bcrc-mobile/js/fun.js"></script>
<script type="text/javascript" src="${resPath}/bcrc-mobile/js/d_jobarea.js"></script>
<script type="text/javascript" src="${resPath}/bcrc-mobile/js/popjobarea.js"></script>
<script type="text/javascript" src="${resPath}/bcrc-mobile/js/resume.js"></script>
<script type="text/javascript" src="${resPath}/bcrc-mobile/js/indtype.js"></script>
<script type="text/javascript" src="${resPath}/bcrc-mobile/js/funtype.js"></script>
<script type="text/javascript" src="${resPath}/bcrc-mobile/js/popfuntype.js"></script>
<script type="text/javascript" src="${resPath}/bcrc-mobile/js/popindtype.js"></script>
<script type="text/javascript">
	var time        = '1572570880666';
	var pagecode    = '30199';
	var cusParam    = "116425202951job_msem_baidupz_570m.51job.com";
	var param   = 'VerType=3&webId=2&logTime=' + time + '&ip=' + $_CONFIG['ip'] + '&guid=db7398e3a4d3205cf89c37f039c6005f&domain=m.51job.com&pageCode=' + pagecode + '&cusParam=' + cusParam;

</script>

<div id="shadow" style="display:none"></div>

<script type="text/javascript">
	$("#qy_jjlx").change(function(){
		var qy_jjlxval=$("#qy_jjlx").val();
		var qy_jjlxtext=$("#qy_jjlx").find("option:selected").text();
		$('#qy_jjlxspan').text(qy_jjlxtext);
		$('#jjlx').val(qy_jjlxval);
	});
	$("#qy_qygm").change(function(){
		var qy_qygmval=$("#qy_qygm").val();
		var qy_qygmtext=$("#qy_qygm").find("option:selected").text();
		$('#qy_qygmspan').text(qy_qygmtext);
		$('#qygm').val(qy_qygmval);
	});
	function update() {
		var qy_id = '${qyInfo.qy_id!}';
		if (qy_id == '') {
		} else {
			$("#qy_qygm").find("option[value='${qyInfo.qy_qygm!}']").attr("selected", 'selected');

			if('${qyInfo.qy_jjlx!}'=='0'){
				$("#qy_jjlxspan").html('国有企业');
				$('#jjlx').val(0);
			}
			else if('${qyInfo.qy_jjlx!}'=='1'){
				$("#qy_jjlxspan").html('集体企业');
				$('#jjlx').val(1);
			}
			else if('${qyInfo.qy_jjlx!}'=='2'){
				$("#qy_jjlxspan").html('私营企业');
				$('#jjlx').val(2);
			}
			else if('${qyInfo.qy_jjlx!}'=='3'){
				$("#qy_jjlxspan").html('个体企业');
				$('#jjlx').val(3);
			}
			else if('${qyInfo.qy_jjlx!}'=='4'){
				$("#qy_jjlxspan").html('联营企业');
				$('#jjlx').val(4);
			}
			else if('${qyInfo.qy_jjlx!}'=='5'){
				$("#qy_jjlxspan").html('股份制企业');
				$('#jjlx').val(5);
			}
			else if('${qyInfo.qy_jjlx!}'=='6'){
				$("#qy_jjlxspan").html('外商投资企业');
				$('#jjlx').val(6);
			}
			else if('${qyInfo.qy_jjlx!}'=='7'){
				$("#qy_jjlxspan").html('港澳台投资企业');
				$('#jjlx').val(7);
			}
			else if('${qyInfo.qy_jjlx!}'=='8'){
				$("#qy_jjlxspan").html('其他企业');
				$('#jjlx').val(8);
			}
			if('${qyInfo.qy_qygm!}'=='0'){
				$("#qy_qygmspan").html('20人以下');
				$('#qygm').val(0);
			}
			else if('${qyInfo.qy_qygm!}'=='1'){
				$("#qy_qygmspan").html('20-99人');
				$('#qygm').val(1);
			}
			else if('${qyInfo.qy_qygm!}'=='2'){
				$("#qy_qygmspan").html('100-499人');
				$('#qygm').val(2);
			}
			else if('${qyInfo.qy_qygm!}'=='3'){
				$("#qy_qygmspan").html('500-999人');
				$('#qygm').val(3);
			}
			else if('${qyInfo.qy_qygm!}'=='4'){
				$("#qy_qygmspan").html('1000-9999人');
				$('#qygm').val(4);
			}
			else if('${qyInfo.qy_qygm!}'=='5'){
				$("#qy_qygmspan").html('10000人以上');
				$('#qygm').val(5);
			}
			var boxObj = $("input:checkbox[name='qy_qyfl']");  //获取所有的复选框
			var expresslist = '${qyInfo.qy_qyfl!}'; //用el表达式获取在控制层存放的复选框的值为字符串类型
			var express = expresslist.split(','); //去掉它们之间的分割符“，”
			for (i = 0; i < boxObj.length; i++) {
				for (j = 0; j < express.length; j++) {
					if (boxObj[i].value == express[j])  //如果值与修改前的值相等
					{
						boxObj[i].checked = true;
						break;
					}
				}
			}
		}
	}


	$("#sc").click(function () {
		$("#myfile").click();
	});
	var myarr=[];
	function printFileInfo(target){
		$("#sc").html('<img src="'+ URL.createObjectURL(target.files[0]) +'"  WIDTH="200" HEIGHT="200"/>')
		var fileSize = 0;
		if ( !target.files) {
			var filePath = target.value;
			var fileSystem = new ActiveXObject("Scripting.FileSystemObject");
			var file = fileSystem.GetFile (filePath);
			fileSize = file.Size;
		} else {
			fileSize = target.files[0].size;
		}
		var size = fileSize / 1024;
		if(size>10240){
			window.wxc.xcConfirm("附件不能大于10M!", "error");
			target.value="";
			return
		}
		var picFile = document.getElementById('myfile');
		var files = picFile.files;
		for(var i=0; i<files.length; i++){
			var file = files[i];
			myarr.push(file)
		}
	}




	function submit() {
		var url = '${ctxPath}/qyzx/UpdateOrInsertQyxx';//数据地址
		var em = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;
		var MyzzTest=/^1[3456789]\d{9}$/;
		var qy_qymc    =$('#qy_qymc').val();
		var qy_file_zz =$('#sc').html();
		var qy_sshy=$('#indtypename').text();
		function trim(str) {
			return str.replace(/(^\s*)|(\s*$)/g, "");
		}
		qy_sshy=trim(qy_sshy);
		var qy_jjlx    =$('#jjlx').val();
		var qy_qygm    =$('#qygm').val();
		var qy_qyjl    =$('#qy_qyjl').val();
		var qy_qywz    =$('#qy_qywz').val();
		var qy_lxr     =$('#qy_lxr').val();
		var qy_yx      =$('#qy_yx').val();
		var qy_xxdz    =$('#qy_xxdz').val();
		var qy_lxdh    =$('#qy_lxdh').val();
		var qy_qyfl    = "";
		$('input[name="qy_qyfl"]:checked').each(function(){
			if(qy_qyfl == "")
				qy_qyfl = $(this).val();
			else
				qy_qyfl+=","+$(this).val();
		});
		if(qy_qymc==''){
			alert("请填写企业名称");
			return;
		}
		if(qy_lxdh!=null&&qy_lxdh !=""){
			if(!(MyzzTest.test(qy_lxdh))){
				alert("手机号码有误,请重新输入");
				return false;
			}
		}
		if(qy_file_zz==''){
			alert("请上传营业执照")
			return;
		}
		if(qy_sshy==''){
			alert("请填写所属行业");
			return;
		}
		if(qy_jjlx==42){
			alert("请选择企业类型")
			return;
		}
		if(qy_qygm==42){
			alert("请选择企业规模");
			return;
		}
		if(qy_lxr==''){
			alert("请填写联系人");
			return;
		}
		var re= /^[1-9][0-9]{5}$/;
		if(qy_yx==''){
			alert("请填写邮箱");
			return;
		}else if(!re.test(qy_yx)){
			alert('邮政编码格式不正确,请重新输入');
			$('#qy_yx').val("");
			return false;

		}
		if(qy_xxdz==''){
			alert("请填写详细地址");
			return;
		}
		var formData = new FormData();
		$.each(myarr,function(i,file){
			formData.append('myfile',file);

		});
		//将file放入formdata中
		formData.append('qy_qymc',qy_qymc);
		formData.append('qy_sshy', qy_sshy);
		formData.append('qy_qyfl', qy_qyfl);
		formData.append('qy_jjlx',qy_jjlx);
		formData.append('qy_qygm',qy_qygm);
		formData.append('qy_qyjl',qy_qyjl);
		formData.append('qy_qywz',qy_qywz);
		formData.append('qy_lxr', qy_lxr);
		formData.append('qy_lxdh',qy_lxdh);
		formData.append('qy_yx',  qy_yx);
		formData.append('qy_xxdz',qy_xxdz);
		$.ajax({
			url : url,
			type : 'POST',
			dataType: 'json',
			data : formData,
			crossDomain: true,
			cache: false,
			processData: false,
			contentType: false,
			success : function(responseStr) {
				alert("修改成功，管理员将在24小时内进行审核，请耐心等待。");
				window.location.href="${ctxPath}/qyzx/goToyprclg";
			},error:function (e) {
				console.log(e);
			}
		});

	}



</script>
<script type="text/javascript">
	function jinggao(){
		alert("您的企业信息还未通过审核或未提交  请耐心等待");
	}
</script>

</body>
</html>
